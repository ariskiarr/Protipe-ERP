<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laporan Stok - Staff Gudang - PT KSteel Nusantara ERP</title>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/style.css" />
  </head>
  <body>
    <!-- Sidebar Navigation -->
    <div class="sidebar">
      <div class="sidebar-header">
        <a href="../index-warehouse.html" class="sidebar-logo">
          <img src="../images/logo.svg" alt="KSteel Logo" />
          <span>KSteel ERP</span>
        </a>
      </div>
      <ul class="sidebar-menu">
        <!-- Menu items will be dynamically populated based on role -->
      </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Header -->
      <div class="header">
        <button class="menu-toggle">
          <i class="fas fa-bars"></i>
        </button>
        <div class="header-right">
          <div class="header-icons">
            <div class="header-icon">
              <i class="fas fa-bell"></i>
              <div class="notification-badge">6</div>
            </div>
            <div class="header-icon">
              <i class="fas fa-envelope"></i>
              <div class="notification-badge">1</div>
            </div>
          </div>
          <div class="user-info">
            <!-- User info will be dynamically populated -->
          </div>
          <button class="logout-btn">Logout</button>
        </div>
      </div>

      <!-- Page Content -->
      <div class="page-container">
        <h1 class="page-title">Laporan Stok</h1>

        <!-- Report Generator -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">Generate Laporan</h2>
            <div>
              <button class="btn btn-outline-primary">
                <i class="fas fa-sync"></i> Refresh Data
              </button>
            </div>
          </div>
          <div class="card-body">
            <div
              style="
                display: flex;
                flex-wrap: wrap;
                gap: 20px;
                margin-bottom: 20px;
              "
            >
              <div class="form-group" style="flex: 1; min-width: 200px">
                <label class="form-label">Jenis Laporan</label>
                <select class="form-select" id="reportType">
                  <option value="current-stock">Stok Saat Ini</option>
                  <option value="stock-movement">Pergerakan Stok</option>
                  <option value="low-stock">Stok Menipis</option>
                  <option value="expired-stock">Barang Kedaluwarsa</option>
                  <option value="slow-moving">Barang Slow-Moving</option>
                </select>
              </div>
              <div class="form-group" style="flex: 1; min-width: 200px">
                <label class="form-label">Rentang Tanggal</label>
                <div style="display: flex; gap: 10px">
                  <input
                    type="date"
                    class="form-control"
                    id="startDate"
                    value="2025-06-01"
                  />
                  <span style="align-self: center">s/d</span>
                  <input
                    type="date"
                    class="form-control"
                    id="endDate"
                    value="2025-06-22"
                  />
                </div>
              </div>
              <div class="form-group" style="flex: 1; min-width: 200px">
                <label class="form-label">Kategori</label>
                <select class="form-select" id="reportCategory">
                  <option value="">Semua Kategori</option>
                  <option value="besi-beton">Besi Beton</option>
                  <option value="besi-siku">Besi Siku</option>
                  <option value="besi-hollow">Besi Hollow</option>
                  <option value="besi-pipa">Pipa Besi</option>
                  <option value="plat">Plat</option>
                </select>
              </div>
            </div>
            <div style="text-align: right">
              <button class="btn btn-accent" id="generateReportBtn">
                <i class="fas fa-file-alt"></i> Generate Laporan
              </button>
              <button class="btn btn-primary" id="exportReportBtn">
                <i class="fas fa-file-export"></i> Export ke Excel
              </button>
            </div>
          </div>
        </div>

        <!-- Report Charts -->
        <div
          style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 20px"
        >
          <div class="card" style="flex: 1; min-width: 350px">
            <div class="card-header">
              <h2 class="card-title">Distribusi Kategori</h2>
            </div>
            <div class="card-body">
              <canvas id="categoryDistributionChart" height="250"></canvas>
            </div>
          </div>

          <div class="card" style="flex: 1; min-width: 350px">
            <div class="card-header">
              <h2 class="card-title">Status Stok</h2>
            </div>
            <div class="card-body">
              <canvas id="stockStatusChart" height="250"></canvas>
            </div>
          </div>
        </div>

        <!-- Stock Movement Chart -->
        <div class="card" style="margin-top: 20px">
          <div class="card-header">
            <h2 class="card-title">Pergerakan Stok</h2>
            <div>
              <button
                class="btn btn-sm btn-outline-primary active"
                data-period="weekly"
              >
                Mingguan
              </button>
              <button
                class="btn btn-sm btn-outline-primary"
                data-period="monthly"
              >
                Bulanan
              </button>
            </div>
          </div>
          <div class="card-body">
            <canvas id="stockMovementChart" height="300"></canvas>
          </div>
        </div>

        <!-- Report Table -->
        <div class="card" style="margin-top: 20px">
          <div class="card-header">
            <h2 class="card-title">Laporan Stok Saat Ini</h2>
            <div class="input-group" style="width: 300px">
              <input
                type="text"
                class="form-control"
                placeholder="Cari barang..."
              />
              <button class="btn btn-outline-primary">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
          <div class="card-body">
            <div class="table-container">
              <table class="table">
                <thead>
                  <tr>
                    <th>Kode</th>
                    <th>Nama Barang</th>
                    <th>Kategori</th>
                    <th>Stok Awal</th>
                    <th>Masuk</th>
                    <th>Keluar</th>
                    <th>Stok Akhir</th>
                    <th>Satuan</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>STL-001</td>
                    <td>Besi Beton 10mm</td>
                    <td>Besi Beton</td>
                    <td>200</td>
                    <td>+200</td>
                    <td>-80</td>
                    <td>320</td>
                    <td>Batang</td>
                    <td>
                      <span class="stock-indicator stock-high"></span> Tersedia
                    </td>
                  </tr>
                  <tr>
                    <td>STL-002</td>
                    <td>Besi Beton 12mm</td>
                    <td>Besi Beton</td>
                    <td>100</td>
                    <td>+0</td>
                    <td>-75</td>
                    <td>25</td>
                    <td>Batang</td>
                    <td>
                      <span class="stock-indicator stock-low"></span> Hampir
                      Habis
                    </td>
                  </tr>
                  <tr>
                    <td>STL-003</td>
                    <td>Besi Siku 40x40</td>
                    <td>Besi Siku</td>
                    <td>200</td>
                    <td>+0</td>
                    <td>-50</td>
                    <td>150</td>
                    <td>Batang</td>
                    <td>
                      <span class="stock-indicator stock-medium"></span>
                      Tersedia
                    </td>
                  </tr>
                  <tr>
                    <td>STL-004</td>
                    <td>Besi UNP 50x38</td>
                    <td>Besi UNP</td>
                    <td>150</td>
                    <td>+0</td>
                    <td>-65</td>
                    <td>85</td>
                    <td>Batang</td>
                    <td>
                      <span class="stock-indicator stock-medium"></span>
                      Tersedia
                    </td>
                  </tr>
                  <tr>
                    <td>STL-005</td>
                    <td>Plat 2mm</td>
                    <td>Plat</td>
                    <td>30</td>
                    <td>+20</td>
                    <td>-5</td>
                    <td>45</td>
                    <td>Lembar</td>
                    <td>
                      <span class="stock-indicator stock-medium"></span>
                      Tersedia
                    </td>
                  </tr>
                  <tr>
                    <td>STL-006</td>
                    <td>Pipa Besi 2"</td>
                    <td>Pipa Besi</td>
                    <td>25</td>
                    <td>+0</td>
                    <td>-25</td>
                    <td>0</td>
                    <td>Batang</td>
                    <td>
                      <span class="stock-indicator stock-zero"></span> Habis
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <!-- Pagination -->
            <div class="pagination">
              <button class="btn btn-sm btn-outline-primary">&laquo;</button>
              <button class="btn btn-sm btn-primary">1</button>
              <button class="btn btn-sm btn-outline-primary">2</button>
              <button class="btn btn-sm btn-outline-primary">3</button>
              <button class="btn btn-sm btn-outline-primary">&raquo;</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="../js/main.js"></script>
    <script src="../js/roles.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Category Distribution Chart
        const categoryCtx = document
          .getElementById("categoryDistributionChart")
          .getContext("2d");
        const categoryChart = new Chart(categoryCtx, {
          type: "pie",
          data: {
            labels: [
              "Besi Beton",
              "Besi Siku",
              "Besi UNP",
              "Besi Hollow",
              "Pipa Besi",
              "Plat",
            ],
            datasets: [
              {
                data: [35, 15, 10, 15, 10, 15],
                backgroundColor: [
                  "#003366",
                  "#005299",
                  "#0066CC",
                  "#0080FF",
                  "#3399FF",
                  "#66B2FF",
                ],
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
          },
        });

        // Stock Status Chart
        const statusCtx = document
          .getElementById("stockStatusChart")
          .getContext("2d");
        const statusChart = new Chart(statusCtx, {
          type: "doughnut",
          data: {
            labels: ["Stok Baik", "Stok Menipis", "Stok Kritis", "Stok Habis"],
            datasets: [
              {
                data: [60, 25, 10, 5],
                backgroundColor: ["#27ae60", "#f39c12", "#e74c3c", "#95a5a6"],
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
          },
        });

        // Stock Movement Chart
        const movementCtx = document
          .getElementById("stockMovementChart")
          .getContext("2d");
        const movementChart = new Chart(movementCtx, {
          type: "line",
          data: {
            labels: ["Minggu 1", "Minggu 2", "Minggu 3", "Minggu 4"],
            datasets: [
              {
                label: "Barang Masuk",
                data: [220, 180, 250, 310],
                borderColor: "#2980b9",
                backgroundColor: "rgba(41, 128, 185, 0.1)",
                tension: 0.3,
                fill: true,
              },
              {
                label: "Barang Keluar",
                data: [180, 200, 220, 240],
                borderColor: "#e74c3c",
                backgroundColor: "rgba(231, 76, 60, 0.1)",
                tension: 0.3,
                fill: true,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
              },
            },
          },
        });

        // Period buttons
        document.querySelectorAll("[data-period]").forEach((btn) => {
          btn.addEventListener("click", function () {
            document
              .querySelectorAll("[data-period]")
              .forEach((b) => b.classList.remove("active"));
            this.classList.add("active");

            const period = this.getAttribute("data-period");
            updateMovementChart(period);
          });
        });

        function updateMovementChart(period) {
          if (period === "weekly") {
            movementChart.data.labels = [
              "Minggu 1",
              "Minggu 2",
              "Minggu 3",
              "Minggu 4",
            ];
            movementChart.data.datasets[0].data = [220, 180, 250, 310];
            movementChart.data.datasets[1].data = [180, 200, 220, 240];
          } else {
            movementChart.data.labels = [
              "Januari",
              "Februari",
              "Maret",
              "April",
              "Mei",
              "Juni",
            ];
            movementChart.data.datasets[0].data = [
              800, 900, 850, 950, 1050, 980,
            ];
            movementChart.data.datasets[1].data = [
              750, 800, 820, 880, 900, 950,
            ];
          }

          movementChart.update();
        }

        // Generate report button
        document
          .getElementById("generateReportBtn")
          .addEventListener("click", function () {
            const reportType = document.getElementById("reportType").value;
            const startDate = document.getElementById("startDate").value;
            const endDate = document.getElementById("endDate").value;
            const category = document.getElementById("reportCategory").value;

            alert(
              `Generating ${reportType} report from ${startDate} to ${endDate}${
                category ? " for category: " + category : ""
              }`
            );
          });

        // Export report button
        document
          .getElementById("exportReportBtn")
          .addEventListener("click", function () {
            alert("Exporting report to Excel...");
          });
      });
    </script>

    <!-- Scripts -->
    <script src="../js/main.js"></script>
    <script src="../js/roles.js"></script>
    <script src="../js/page-init.js"></script>
  </body>
</html>
